<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ARIA live regions: Updating live regions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../-assets/shared.css">
    <style>

    </style>
  </head>
  <body>
    <div id="app">
      <header>
        <h1>Testing the updating of ARIA live regions & friends</h1>
        <div class="dates">
          <p>Published: <time>June 20, 2019</time></p>
          <p>Updated: <time>July 5, 2019</time></p>
        </div>
      </header>

      <div class="test">
        <h2><code>aria-live="polite"</code> injected into the DOM with button press</h2>
        <div class="test__case">
          <button id="injectPolite">Inject polite content</button>
          <div aria-live="polite"></div>
<script>
  (function () {
    var btn = document.getElementById('injectPolite');
    var region = btn.parentNode.querySelector('[aria-live]');

    btn.addEventListener('click', function () {
      region.innerHTML = "<p>Injected polite content. <a href='#!'>oh hi</a>.</p><ul><li>test</li><li>test2</li></ul>";
    });
  })();
</script>
        </div>

        <div class="test__info">
          <div class="test__info__results">
            <details>
              <summary>results</summary>
              <div>
                <p>Expectation: should announce flattened text string.</p>
                <ul>
                  <li>macOS 10.14.4 VoiceOver with Safari 12.1: Live announcement of content as text string, but not list content.</li>
                  <li>macOS 10.14.4 VoiceOver with Chrome 75: Live announcement of all content as a text string, including bullets.</li>

                  <li>JAWS 2019 (june) with IE11: Live announcement of all content as a text string, including bullets.</li>
                  <li>JAWS 2019 (june) with Edge 76 dev: ??? .</li>
                  <li>JAWS 2019 (june) with Chrome 75: ??? .</li>
                  <li>JAWS 2019 (june) with Firefox 67.0.3: Live announcement of all content as a text string, including bullets. All content announced twice.</li>

                  <li>NVDA 2019.1.1 with IE11: ??? .</li>
                  <li>NVDA 2019.1.1 with Edge 76 dev: ??? .</li>
                  <li>NVDA 2019.1.1 with Chrome 75: ??? .</li>
                  <li>NVDA 2019.1.1 with Firefox 67.0.3: ??? .</li>

                  <li>Android 8.1 TalkBack 7.3 with Firefox 67.0.3: No live announcement made.</li>
                  <li>Android 8.1 TalkBack 7.3 with Chrome 75: Live announcement of content, including list role, but not in the order it appears on screen and inconsistently with duplicate announcements.</li>
                  <li>iOS 12.3.1 VoiceOver with Safari: Live announcement of all content as a text string, including bullets.</li>
                </ul>
              </div>
            </details>
          </div>
        </div>
      </div>


      <div class="test">
        <h2><code>aria-live="assertive"</code> injected into the DOM with button press</h2>
        <div class="test__case">
          <button id="injectAssertive">Inject Assertive</button>
          <div aria-live="assertive"></div>
<script>
  (function () {
    var btn = document.getElementById('injectAssertive');
    var region = btn.parentNode.querySelector('[aria-live]');

    btn.addEventListener('click', function () {
      region.innerHTML = "<p>Injected assertive content. <a href='#!'>oh hi</a>.</p><ul><li>test</li><li>test2</li></ul>";
    });
  })();
</script>
        </div>

        <div class="test__info">
          <div class="test__info__results">
            <details>
              <summary>results</summary>
              <div>
                <p>Expectation: should announce flattened text string.</p>
                <ul>
                  <li>macOS 10.14.4 VoiceOver with Safari 12.1: Live announcement of content as text string, but not list content.</li>
                  <li>macOS 10.14.4 VoiceOver with Chrome 75: Live announcement of all content as a text string, including bullets.</li>

                  <li>JAWS 2019 (june) with IE11: Live announcement of all content as a text string, including bullets.</li>
                  <li>JAWS 2019 (june) with Edge 76 dev: ??? .</li>
                  <li>JAWS 2019 (june) with Chrome 75: ??? .</li>
                  <li>JAWS 2019 (june) with Firefox 67.0.3: Live announcement of all content as a text string, including bullets. All content announced twice.</li>

                  <li>NVDA 2019.1.1 with IE11: ??? .</li>
                  <li>NVDA 2019.1.1 with Edge 76 dev: ??? .</li>
                  <li>NVDA 2019.1.1 with Chrome 75: ??? .</li>
                  <li>NVDA 2019.1.1 with Firefox 67.0.3: ??? .</li>

                  <li>Android 8.1 TalkBack 7.3 with Firefox 67.0.3: No live announcement made.</li>
                  <li>Android 8.1 TalkBack 7.3 with Chrome 75: Alert role and accessible nameLive announcement of text string, and list role, only. Link text and list item text are not announced.</li>
                  <li>iOS 12.3.1 VoiceOver with Safari: Live announcement of all content as a text string, including bullets.</li>
                </ul>
              </div>
            </details>
          </div>
        </div>
      </div>


      <div class="test">
        <h2><code>role="alert"</code> injected into the DOM with button press</h2>
        <div class="test__case">
          <button id="injectAlert">Inject Alert</button>
          <div role="alert" aria-label="test A"></div>
<script>
  (function () {
    var btn = document.getElementById('injectAlert');
    var region = btn.parentNode.querySelector('[role]');

    btn.addEventListener('click', function () {
      region.innerHTML = "<p>Injected important content. <a href='#!'>oh hi</a>.</p><ul><li>test</li><li>test2</li></ul>";
    });
  })();
</script>
        </div>

        <div class="test__info">
          <div class="test__info__results">
            <details>
              <summary>results</summary>
              <div>
                <p>Expectation: should announce flattened text string.</p>
                <ul>
                  <li>macOS 10.14.4 VoiceOver with Safari 12.1: Live announcement of all content as a text string, including bullets. Navigating to containing element announces accName and role.</li>
                  <li>macOS 10.14.4 VoiceOver with Chrome 75: Live announcement of accessible name and all content as a text string, including bullets. Navigating to containing element announces accName and role.</li>

                  <li>JAWS 2019 (june) with IE11: Live announcement of all content as a text string, including bullets and accessible name.</li>
                  <li>JAWS 2019 (june) with Edge 76 dev: ??? .</li>
                  <li>JAWS 2019 (june) with Chrome 75: ??? .</li>
                  <li>JAWS 2019 (june) with Firefox 67.0.3: Alert role and accessible name announced. Live announcement of all content as a text string, including bullets. Navigating into status with <kbd>Tab</kbd> key, focusing link, accName of status announced, but not role. Navigating with virtual cursor to status does not announce accName or role.</li>

                  <li>NVDA 2019.1.1 with IE11: ??? .</li>
                  <li>NVDA 2019.1.1 with Edge 76 dev: ??? .</li>
                  <li>NVDA 2019.1.1 with Chrome 75: ??? .</li>
                  <li>NVDA 2019.1.1 with Firefox 67.0.3: ??? .</li>

                  <li>Android 8.1 TalkBack 7.3 with Firefox 67.0.3: No live announcement made. Navigating to containing element does not announce accName or role.</li>
                  <li>Android 8.1 TalkBack 7.3 with Chrome 75: Alert role and accessible name announced. Live announcement of text string, and list role, only. Link text and list item text are not announced. Navigating to containing element does not announce accName or role.</li>
                  <li>iOS 12.3.1 VoiceOver with Safari: Live announcement of all content as a text string, including bullets. Navigating to containing element does not announce accName or role.</li>
                </ul>
              </div>
            </details>
          </div>
        </div>
      </div>


      <div class="test">
        <h2><code>role="status"</code> injected into the DOM with button press</h2>
        <div class="test__case">
          <button id="injectstatus">Inject status</button>
          <div role="status" aria-label="Test B"></div>
<script>
  (function () {
    var btn = document.getElementById('injectstatus');
    var region = btn.parentNode.querySelector('[role]');

    btn.addEventListener('click', function () {
      region.innerHTML = "<p>Injected 'this just happened' content. <a href='#!'>oh hi</a>.</p><ul><li>test</li><li>test2</li></ul>";
    });
  })();
</script>
        </div>

        <div class="test__info">
          <div class="test__info__results">
            <details>
              <summary>results</summary>
              <div>
                <p>Expectation: should announce flattened text string.</p>
                <ul>
                  <li>macOS 10.14.4 VoiceOver with Safari 12.1: Live announcement of all content as a text string, including bullets. Navigating to containing element announces accName and role "application status".</li>
                  <li>macOS 10.14.4 VoiceOver with Chrome 75: Live announcement of accessible name and all content as a text string, including bullets. Navigating to containing element announces accName and role "status".</li>

                  <li>JAWS 2019 (june) with IE11: Live announcement of all content as a text string, including bullets and accessible name.</li>
                  <li>JAWS 2019 (june) with Edge 76 dev: ??? .</li>
                  <li>JAWS 2019 (june) with Chrome 75: ??? .</li>
                  <li>JAWS 2019 (june) with Firefox 67.0.3: Live announcement of all content as a text string, including bullets. All content announced twice. Role and accName not announced as part of live announcement. Navigating into status with <kbd>Tab</kbd> key, focusing link, accName of status announced, but not role. Navigating with virtual cursor to status does not announce accName or role.</li>

                  <li>NVDA 2019.1.1 with IE11: ??? .</li>
                  <li>NVDA 2019.1.1 with Edge 76 dev: ??? .</li>
                  <li>NVDA 2019.1.1 with Chrome 75: ??? .</li>
                  <li>NVDA 2019.1.1 with Firefox 67.0.3: ??? .</li>

                  <li>Android 8.1 TalkBack 7.3 with Firefox 67.0.3: No live announcement made. Navigating to containing element does not announce accName or role.</li>
                  <li>Android 8.1 TalkBack 7.3 with Chrome 75: Live announcement of all content as a text string, including bullets. List role announced. Status role and accessible name announced. Announcement of content not in order, and contains duplicate announcements. Navigating to containing element does not announce accName or role.</li>
                  <li>iOS 12.3.1 VoiceOver with Safari: Live announcement of all content as a text string, including bullets. Navigating to containing element does not announce accName or role.</li>
                </ul>
              </div>
            </details>
          </div>
        </div>
      </div>


      <div class="test">
        <h2><code>role="log"</code> injected into the DOM with button press</h2>
        <div class="test__case">
          <button id="injectLog">Inject log</button>
          <div role="log" aria-label="Test C"></div>
<script>
  (function () {
    var btn = document.getElementById('injectLog');
    var region = btn.parentNode.querySelector('[role]');

    btn.addEventListener('click', function () {
      region.innerHTML = "<p>Injected historical content. <a href='#!'>oh hi</a>.</p><ul><li>test</li><li>test2</li></ul>";
    });
  })();
</script>
        </div>

        <div class="test__info">
          <div class="test__info__results">
            <details>
              <summary>results</summary>
              <div>
                <p>Expectation: should announce flattened text string.</p>
                <ul>
                  <li>macOS 10.14.4 VoiceOver with Safari 12.1: Live announcement of all content as a text string, including bullets. Navigating to containing element announces accName and role.</li>
                  <li>macOS 10.14.4 VoiceOver with Chrome 75: Live announcement of all content as a text string, including bullets. Navigating to containing element announces accName and role.</li>

                  <li>JAWS 2019 (june) with IE11: Live announcement of all content as a text string, including bullets. Accessible name announced twice.</li>
                  <li>JAWS 2019 (june) with Edge 76 dev: ??? .</li>
                  <li>JAWS 2019 (june) with Chrome 75: ??? .</li>
                  <li>JAWS 2019 (june) with Firefox 67.0.3: Live announcement of all content as a text string, including bullets. All content announced twice. Role and accName not announced as part of live announcement. Navigating into log with <kbd>Tab</kbd> key, focusing link, accName and role log announced. Navigating with virtual cursor to log does not announce accName or role.</li>

                  <li>NVDA 2019.1.1 with IE11: ??? .</li>
                  <li>NVDA 2019.1.1 with Edge 76 dev: ??? .</li>
                  <li>NVDA 2019.1.1 with Chrome 75: ??? .</li>
                  <li>NVDA 2019.1.1 with Firefox 67.0.3: ??? .</li>

                  <li>Android 8.1 TalkBack 7.3 with Firefox 67.0.3: No live announcement made. Navigating to containing element does not announce accName or role.</li>
                  <li>Android 8.1 TalkBack 7.3 with Chrome 75: Live announcement of all content as a text string, including bullets. List role announced. Log role and accessible name announced. Contained duplicate announcements. Navigating to containing element does not announce accName or role.</li>
                  <li>iOS 12.3.1 VoiceOver with Safari: Live announcement of all content as a text string, including bullets. Navigating to containing element does not announce accName or role.</li>
                </ul>
              </div>
            </details>
          </div>
        </div>
      </div>


      <div class="test">
        <h2><code>role="marquee"</code> injected into the DOM with button press</h2>
        <div class="test__case">
          <button id="injectMarquee">Inject marquee</button>
          <div role="marquee" aria-label="Test D"></div>
<script>
  (function () {
    var btn = document.getElementById('injectMarquee');
    var region = btn.parentNode.querySelector('[role]');

    btn.addEventListener('click', function () {
      region.innerHTML = "<p>Injected content. <a href='#!'>oh hi</a>.</p><ul><li>test</li><li>test2</li></ul>";
    });
  })();
</script>
        </div>

        <div class="test__info">
          <div class="test__info__results">
            <details>
              <summary>results</summary>
              <div>
                <p>Expectation: no initial announcement. Default is <code>aria-live=off</code>.</p>
                <ul>
                  <li>macOS 10.14.4 VoiceOver with Safari 12.1: Injected content not announced. Navigating to containing element announces accName and role.</li>
                  <li>macOS 10.14.4 VoiceOver with Chrome 75: Injected content not announced. Navigating to containing element announces accName and role.</li>

                  <li>JAWS 2019 (june) with IE11: No live announcement made. Navigating into marquee with <kbd>Tab</kbd> key, focusing link, or by virtual cursor, neither accName nor role are announced.</li>
                  <li>JAWS 2019 (june) with Edge 76 dev: ??? .</li>
                  <li>JAWS 2019 (june) with Chrome 75: ??? .</li>
                  <li>JAWS 2019 (june) with Firefox 67.0.3: No live announcement made. Navigating into marquee with <kbd>Tab</kbd> key, focusing link, accName announced but not role. Navigating with virtual cursor to marquee does not announce accName or role.</li>

                  <li>NVDA 2019.1.1 with IE11: ??? .</li>
                  <li>NVDA 2019.1.1 with Edge 76 dev: ??? .</li>
                  <li>NVDA 2019.1.1 with Chrome 75: ??? .</li>
                  <li>NVDA 2019.1.1 with Firefox 67.0.3: ??? .</li>

                  <li>Android 8.1 TalkBack 7.3 with Firefox 67.0.3: No live announcement made. Navigating to containing element does not announce accName or role.</li>
                  <li>Android 8.1 TalkBack 7.3 with Chrome 75: No live announcement made. Navigating to containing element, no role or accName announced. Navigating to containing element does not announce accName or role.</li>
                  <li>iOS 12.3.1 VoiceOver with Safari: Injected content not announced. Navigating to containing element does not announce accName or role.</li>
                </ul>
              </div>
            </details>
          </div>
        </div>
      </div>


      <div class="test">
        <h2><code>role="timer"</code> injected into the DOM with button press</h2>
        <div class="test__case">
          <button id="injectTimer">Inject timer</button>
          <div role="timer" aria-label="Test E"></div>
<script>
  (function () {
    var btn = document.getElementById('injectTimer');
    var region = btn.parentNode.querySelector('[role]');

    btn.addEventListener('click', function () {
      region.innerHTML = "<p>10 minutes remaining. <a href='#!'>oh hi</a>.</p>";
    });
  })();
</script>
        </div>

        <div class="test__info">
          <div class="test__info__results">
            <details>
              <summary>results</summary>
              <div>
                <p>Expectation: no initial announcement. Default is <code>aria-live=off</code>.</p>
                <ul>
                  <li>macOS 10.14.4 VoiceOver with Safari 12.1: Injected content not announced. Navigating to containing element announces accName and role.</li>
                  <li>macOS 10.14.4 VoiceOver with Chrome 75: Injected content not announced. Navigating to containing element announces accName and role.</li>

                  <li>JAWS 2019 (june) with IE11: No live announcement made. Navigating into marquee with <kbd>Tab</kbd> key, focusing link, or by virtual cursor, neither accName nor role are announced.</li>
                  <li>JAWS 2019 (june) with Edge 76 dev: ??? .</li>
                  <li>JAWS 2019 (june) with Chrome 75: ??? .</li>
                  <li>JAWS 2019 (june) with Firefox 67.0.3: No live announcement made. Navigating into timer with <kbd>Tab</kbd> key, focusing link, accName announced but not role. Navigating with virtual cursor to timer does not announce accName or role.</li>

                  <li>NVDA 2019.1.1 with IE11: ??? .</li>
                  <li>NVDA 2019.1.1 with Edge 76 dev: ??? .</li>
                  <li>NVDA 2019.1.1 with Chrome 75: ??? .</li>
                  <li>NVDA 2019.1.1 with Firefox 67.0.3: ??? .</li>

                  <li>Android 8.1 TalkBack 7.3 with Firefox 67.0.3: No live announcement made. Navigating to containing element does not announce accName or role.</li>
                  <li>Android 8.1 TalkBack 7.3 with Chrome 75: No live announcement made. Navigating to containing element, no role or accName announced. Navigating to containing element does not announce accName or role.</li>
                  <li>iOS 12.3.1 VoiceOver with Safari: Injected content not announced. Navigating to containing element does not announce accName or role.</li>
                </ul>
              </div>
            </details>
          </div>
        </div>
      </div>



      <div class="test">
        <h2><code>role="progressbar"</code> injected into the DOM with button press</h2>
        <div class="test__case">
          <button id="injectProgress">Update progress bar</button>
          <div role="progressbar" aria-label="test F" aria-valuenow="0" aria-valuemax="100" aria-valuemin="0">0</div>
<script>
  (function () {
    var btn = document.getElementById('injectProgress');
    var prog = btn.parentNode.querySelector('[role]');
    var val = 50;

    btn.addEventListener('click', function () {
      prog.setAttribute('aria-valuenow', val);
      prog.innerHTML = val;
      started = true;
    });


    var started = false;
    function count() {
      if ( started && val < 100) {
        val++
        prog.setAttribute('aria-valuenow', val);
        prog.innerHTML = val;
      }
    }

    var interval = setInterval(count,1000);

  })();
</script>
        </div>

        <div class="test__info">
          <div class="test__info__results">
            <details>
              <summary>results</summary>
              <div>
                <p>Expectation: no initial announcement.</p>
                <ul>
                  <li>macOS 10.14.4 VoiceOver with Safari 12.1: No live announcement made. Navigating to containing element announces accName and role. When focused "ticking" noise is made to indicate updating.</li>
                  <li>macOS 10.14.4 VoiceOver with Chrome 75: No live announcement made. Navigating to containing element announces accName and role. When focused "ticking" noise is made to indicate updating.</li>

                  <li>JAWS 2019 (june) with IE11: When progress bar is dynamically updating, live announcements of current value will be made every few seconds. Navigating to progress bar with virtual cursor, progress bar role and current value are announced, but not accessible name.</li>
                  <li>JAWS 2019 (june) with Edge 76 dev: ??? .</li>
                  <li>JAWS 2019 (june) with Chrome 75: ??? .</li>
                  <li>JAWS 2019 (june) with Firefox 67.0.3: When progress bar is dynamically updating, live announcements of current value will be made every few seconds.
                  Navigating to progress bar with virtual cursor, progress bar role and current value are announced, but not accessible name.</li>

                  <li>NVDA 2019.1.1 with IE11: ??? .</li>
                  <li>NVDA 2019.1.1 with Edge 76 dev: ??? .</li>
                  <li>NVDA 2019.1.1 with Chrome 75: ??? .</li>
                  <li>NVDA 2019.1.1 with Firefox 67.0.3: ??? .</li>

                  <li>Android 8.1 TalkBack 7.3 with Firefox 67.0.3: No live announcement made. Navigating to containing element announces accName and role. No indication of dynamic updates made, or current value.</li>
                  <li>Android 8.1 TalkBack 7.3 with Chrome 75: No live announcement made. Navigating to containing element announces accName and "progress indicator" role. Current progress value not announced.</li>
                  <li>iOS 12.3.1 VoiceOver with Safari: No live announcement made. Navigating to containing element announces accName but not role. No indication of dynamic updates made.</li>
                </ul>
              </div>
            </details>
          </div>
        </div>
      </div>

      <h2>Notes:</h2>
      <p>
        When testing this page with Talkback and Chrome, the accessible name and roles of various live regions were automatically announced on page load (e.g., alert, status and log).
      </p>

    </div> <!-- /#app -->

    <script src="../-assets/shared.js"></script>
  </body>
</html>
